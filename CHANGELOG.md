# 更新日志

本文档记录项目的所有重要更改。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [未发布]

### 计划添加
- 心率变异性 (HRV) 分析
- SD卡数据存储功能
- 蓝牙数据传输
- 多用户配置文件

## [1.1.0] - 2025-01-15

### 新增
- ✨ **双算法支持**: 新增基于DPT(离散周期变换)的频域分析算法
- ✨ **方法2**: ppg_algorithm_v2.c/h 实现完整的DPT算法
- ✨ **算法切换**: 提供main_usage_example.c展示如何切换算法
- ✨ **算法对比**: 支持同时运行两种算法进行对比

### 算法特性
- 🧮 滑动DPT变换（基于Analog Devices RAQ-230论文）
- 🧮 IIR滤波器提取AC/DC分量
- 🧮 周期域频谱分析（161点分辨率）
- 🧮 直接从频谱峰值计算心率和血氧
- 🧮 10秒缓冲区实现高精度测量

### 文档
- 📚 更新 README.md 添加双算法说明
- 📚 添加算法对比表格
- 📚 添加方法2配置参数说明
- 📚 添加方法2性能指标
- 📚 添加使用示例代码

### 性能指标 (方法2)
- ⚡ 初始稳定时间：~10秒
- ⚡ 心率精度：±2 bpm (理论)
- ⚡ 血氧精度：±2%
- ⚡ CPU占用率：<50%
- ⚡ 内存占用：~8KB RAM
- ⚡ 频谱分辨率：161点

## [1.0.0] - 2025-01-12

### 新增
- ✨ 完整的心率检测功能（30-150 bpm）
- ✨ 血氧饱和度测量（70-100%）
- ✨ 实时PPG波形显示
- ✨ OLED 显示界面（128x64）
- ✨ 串口数据输出（115200 bps）

### 核心算法
- 🧮 去趋势滤波（50点移动平均）
- 🧮 Butterworth 4阶带通滤波器（0.5-4 Hz）
- 🧮 自适应峰值检测（7点窗口）
- 🧮 中位数滤波（7点）
- 🧮 EMA平滑（α=0.2）
- 🧮 显示稳定化（双层EMA + 阈值过滤）

### 硬件支持
- 🔧 STM32F103C8T6 微控制器
- 🔧 MAX30102 心率血氧传感器
- 🔧 0.96" OLED显示屏
- 🔧 软件I2C + 硬件I2C
- 🔧 UART2串口调试

### 文档
- 📚 完整的 README.md
- 📚 算法原理说明（docs/algorithm.md）
- 📚 硬件连接指南（docs/hardware.md）
- 📚 贡献指南（CONTRIBUTING.md）
- 📚 MIT 许可证

### 性能指标
- ⚡ 初始稳定时间：~5秒
- ⚡ 更新频率：2.5秒/次
- ⚡ CPU占用率：<30%
- ⚡ 内存占用：~8KB RAM
- ⚡ 心率精度：±3 bpm
- ⚡ 血氧精度：±2%

## [0.5.0] - 2025-01-10 (Beta)

### 新增
- 基础心率检测算法
- MAX30102驱动程序
- OLED显示驱动

### 修复
- 修复I2C通信不稳定问题
- 优化滤波器参数

## [0.3.0] - 2025-01-08 (Alpha)

### 新增
- 项目初始化
- STM32 HAL配置
- 基础外设驱动

---

## 版本类型说明

- **新增 (Added)**：新功能
- **变更 (Changed)**：现有功能的变更
- **废弃 (Deprecated)**：即将移除的功能
- **移除 (Removed)**：已移除的功能
- **修复 (Fixed)**：Bug 修复
- **安全 (Security)**：安全相关的修复

## 图例

- ✨ 新功能
- 🐛 Bug修复
- 🔧 硬件相关
- 🧮 算法优化
- 📚 文档更新
- ⚡ 性能提升
- 🔒 安全修复
- ♻️ 代码重构
- 🎨 UI/UX改进
- 🔥 移除功能
